// Test: Component-local enum with JSON pod type in same component
// Both should be flattened with ComponentName_ prefix

component MixedTypes {
    enum Status {
        Pending,
        Success,
        Error
    }
    
    pod Response {
        string message;
        int code;
    }
    
    mut Status status = Status::Pending;
    mut Response response;

    def handleSuccess(Response r, Meta meta) : void {
        response = r;
        if (meta.has(Response.code) && r.code == 200) {
            status = Status::Success;
        } else {
            status = Status::Error;
        }
    }

    def handleError(string error) : void {
        status = Status::Error;
    }
    
    mount {
        string jsonData = `{"message": "OK", "code": 200}`;
        match (Json.parse(Response, jsonData)) {
            Success(Response r, Meta meta) => handleSuccess(r, meta);
            Error(string error) => handleError(error);
        };
    }
    
    view {
        <div>
            Status: {status == Status::Pending ? "Pending" : (status == Status::Success ? "Success" : "Error")}
            {status == Status::Success ? " - " + response.message : ""}
        </div>
    }
}

app {
    root = MixedTypes;
}
