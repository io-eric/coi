// Test: Match-based JSON parsing with selective binding
pod User {
    string name;
    int age;
}

component FlexibleCallbackTest {
    mut string status = "Not started";
    mut User user;

    def handleSuccess(User u, Meta meta) : void {
        user = u;
        status = "Got user: ${u.name}";
    }

    def handleError(string error) : void {
        status = "Error: " + error;
    }

    def parseJson() : void {
        string json = `{"name": "Bob", "age": 30}`;
        match (Json.parse(User, json)) {
            Success(User u, Meta meta) => handleSuccess(u, meta);
            Error(string error) => handleError(error);
        };
    }

    view {
        <div>
            <p>Status: {status}</p>
        </div>
    }
}

app {
    root = FlexibleCallbackTest;
}
