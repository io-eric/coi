// Test: Fetch POST with callback registration - should pass
// Tests the callback-based Fetch POST API with body and named arguments

component TestFetchPost {
    mut string result = "Not started";
    mut bool loading = false;

    def handleSuccess(string data) : void {
        loading = false;
        result = data;
    }

    def handleError(string error) : void {
        loading = false;
        result = "Error: " + error;
    }

    def doPost() : void {
        loading = true;
        result = "Posting...";
        FetchRequest.post(
            "https://httpbin.org/post",
            "{\"message\": \"hello\"}",
            &onSuccess = handleSuccess,
            &onError = handleError
        );
    }

    view {
        <div>
            <button onclick={doPost}>Post Data</button>
            <p>Status: {loading ? "Posting" : "Idle"}</p>
            <p>Result: {result}</p>
        </div>
    }
}

app {
    root = TestFetchPost;
}
